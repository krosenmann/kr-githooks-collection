#+TITLE: Git Hooks Collection
#+AUTHOR: Roman Zayrullin
#+EMAIL: krosenmann@gmail.com
#+STARTUP: showall
#+LaTeX_ClASS_OPTIONS: [11pt,a4paper,ubuntu]
#+LaTeX_HEADER:\usepackage[scale=0.75]{geometry}
#+LaTeX_HEADER:\usepackage[utf-8]{inputrec}

–•—É–∫–∏, –æ–±–ª–µ–≥—á–∞—é—â–∏–µ —Ç—Ä—É–¥–æ–≤—ã–µ–±—É–¥–Ω–∏.
* –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–¥.
  –ü–æ–º–µ—á–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–¥ -- —Ö–æ—Ä–æ—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ. –ü–æ–º–µ—á–∞–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–π
  –∫–æ–¥. –ù–∞–∑—ã–≤–∞–π—Ç–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∏–ª–∏ –¥–æ–±–∞–≤–ª—è–π—Ç–µ
  —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π. –Ø, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ø–æ–º–µ—á–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞
  –∏—Å–ø–æ–ª—å–∑—É—é —Å–ª–æ–≤–æ ~Petuch~ –≤ –¥–∞–Ω–Ω—ã—Ö, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –∏–ª–∏ –∫–∞–∫ –∏–º—è
  –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.
  –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –±—Ä—è–∫–æ–≤ —É –≥–Ω—É—Ç–æ–≥–æ —Å–µ–º–µ–π—Å—Ç–≤–∞ –¥–µ–±–∞–≥–≥–µ—Ä–æ–≤, –µ—Å—Ç—å
  –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä—è—Ç—å –µ–≥–æ –Ω–∞–ª–∏—á–∏–µ –≤ –∫–æ–¥–µ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º. 
  –•—É–∫ –æ—Ç–ª–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ–º–µ—á–µ–Ω–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–¥ –∏ –±—Ä—è–∫–∏ –≥–Ω—É—Ç—ã—Ö –¥–µ–±–∞–≥–≥–µ—Ä–æ–≤ –∏
  –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç –∫–æ–º–º–∏—Ç –ø—Ä–∏ –∏—Ö –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–∏. 
#+NAME: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ–≥–æ\–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞
#+BEGIN_SRC shell :export results
pdb_check=$(git grep -i '; Tracer()()\|.set_trace()\|petuch' -- '*.py')

if [ ${#pdb_check} -gt 0 ]
then
        echo -e "\e[31mCOMMIT REJECTED: commit contains code with break points. Please remove before commiting.\e[0m"
        echo $pdb_check
        exit 1
else
        echo -e "\e[36mCode contains no break points\e[0m"
fi
#+end_src

#+RESULTS: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ–≥–æ\–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞
: [36mCode contains no break points[0m

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∂–∞–Ω–≥–æ-–ø—Ä–æ–µ–∫—Ç–æ–≤
#+NAME: commit_after_tests
#+begin_src shell
source .venv/bin/activate
./manage.py test
RESULT=$?
if [ $RESULT -ne 0 ]
then
    echo -e "\e[31mCOMMIT REJECTED: Test's failed!\e[0m"
    exit 1
else
    echo -e "\e[36mTest Passed\e[0m"
fi

exit 0
#+end_src
* –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Å–±–æ—Ä–∫–∞
  –í –±–ª–æ–∫ –∫–æ–¥–∞ –Ω–∏–∂–µ –≤—Å—Ç–∞–≤–∏—Ç—å –∏–º–µ–Ω–∞ —á–∞–Ω–∫–æ–≤ –≤ noweb-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å–µ –∏
  –≤—ã–ø–æ–ª–Ω–∏—Ç—å ~org-babel-tanle~ (–ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é ~C-c C-v t~)
  #+BEGIN_SRC shell :tanle pre-commit
    <<check_bps>>
  #+END_SRC
